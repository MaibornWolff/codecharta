<mat-select
	[panelClass]="'cc-metric-chooser'"
	[value]="selectedMetricKey"
	(selectionChange)="handleMetricChanged($event.value)"
	(openedChange)="handleOpenedChanged($event)"
	[disabled]="isDisabled"
>
	<mat-form-field class="cc-metric-chooser-search-field">
		<em class="fa fa-search search-icon" matPrefix></em>
		<input #searchTermInput matInput type="text" [placeholder]="searchPlaceholder" [(ngModel)]="searchTerm" />
	</mat-form-field>
	<div class="cc-metric-chooser-option-container">
		<ng-container *ngFor="let metric of metricData$ | async | filterMetricDataBySearchTerm: searchTerm">
			<ng-container *ngIf="metric.title; then titleExists; else onlyShowKey"></ng-container>
			<ng-template #titleExists>
				<ng-container *ngIf="metric.description; then showTitleAndDescription; else showTitle"></ng-container>
			</ng-template>

			<ng-template #showTitleAndDescription>
				<mat-option [value]="metric.key" matTooltip="{{ metric.key + ': ' + metric.description }}">
					{{ metric.title }}
					<span class="metric-max-value">({{ metric.maxValue }})</span>
				</mat-option>
			</ng-template>
			<ng-template #showTitle>
				<mat-option [value]="metric.key" matTooltip="{{ metric.key }}">
					{{ metric.title }}
					<span class="metric-max-value">({{ metric.maxValue }})</span>
				</mat-option>
			</ng-template>
			<ng-template #onlyShowKey>
				<mat-option [value]="metric.key">
					{{ metric.key }}
					<span class="metric-max-value">({{ metric.maxValue }})</span>
				</mat-option>
			</ng-template>
		</ng-container>
	</div>
</mat-select>

<ng-content select="[hoveredInformation]"></ng-content>
