@for (customConfigItemGroup of customConfigItemGroups | keyvalue; track customConfigItemGroup.key) {
    <div class="collapse collapse-arrow bg-base-100 border-b border-black">
        <input
            type="checkbox"
            [checked]="isGroupExpanded(customConfigItemGroup.key) || searchTerm.length > 0"
            (change)="toggleGroupExpansion(customConfigItemGroup.key)"
        />
        <div class="collapse-title text-base font-normal px-1 py-4">
            <span class="custom-config-item-group-title">
                Custom View(s) in
                <strong> {{ customConfigItemGroup.value.mapSelectionMode | titlecase }} </strong>
                mode for
                {{ customConfigItemGroup.value.mapNames }}
            </span>
        </div>
        <div class="collapse-content px-4">
            @if (customConfigItemGroup.value.customConfigItems | filterCustomConfigDataBySearchTerm: searchTerm; as filteredCustomConfigs) {
            @if (filteredCustomConfigs.length > 0) {
                <div class="flex flex-col">
                    @for (customConfig of filteredCustomConfigs; track customConfig) {
                        <div
                            class="border-b border-black py-2 px-1 hover:bg-black/5 cursor-pointer transition-colors"
                            title="{{ customConfig | customConfig2ApplicableMessage }}"
                        >
                            <div class="metrics-box">
                                <p class="config-item-name" title="{{ customConfig.name }}">
                                    <strong>
                                        <button
                                            type="button"
                                            class="text-button"
                                            (click)="applyCustomConfig(customConfig.id)"
                                            mat-dialog-close>
                                            {{ customConfig.name | truncateText: 75 }}
                                        </button>
                                    </strong>
                                </p>
                            </div>
                            <div class="custom-config-note">
                                <p class="custom-config-note-content">
                                    <button
                                        type="button"
                                        class="text-button"
                                        (click)="applyCustomConfig(customConfig.id)"
                                        mat-dialog-close>
                                        {{ customConfig.note ? (customConfig.note | truncateText: 95) : "Add Note" }}
                                    </button>
                                </p>
                                <cc-custom-config-note-dialog-button
                                    [customConfigItem]="customConfig"
                                ></cc-custom-config-note-dialog-button>
                            </div>
                            <div class="custom-config-action-buttons">
                                <cc-apply-custom-config-button [customConfigItem]="customConfig"></cc-apply-custom-config-button>
                                <button
                                    class="remove-button"
                                    title="Remove Custom View"
                                    (click)="removeCustomConfig(customConfig.id, customConfigItemGroup.key)"
                                >
                                    <i class="fa fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    }
                </div>
            }
            @if (filteredCustomConfigs.length === 0) {
                <div class="no-configs-found-message">
                    <p>No configurations found.</p>
                </div>
            }
            }
        </div>
    </div>
}
